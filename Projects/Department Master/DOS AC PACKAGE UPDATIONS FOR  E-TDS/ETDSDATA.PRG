*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        03/09/04            ETDSDATA.PRG               17:22:13 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 2004 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("etdsdat") ;
	OR UPPER(WTITLE("ETDSDAT")) == "ETDSDAT.PJX" ;
	OR UPPER(WTITLE("ETDSDAT")) == "ETDSDAT.SCX" ;
	OR UPPER(WTITLE("ETDSDAT")) == "ETDSDAT.MNX" ;
	OR UPPER(WTITLE("ETDSDAT")) == "ETDSDAT.PRG" ;
	OR UPPER(WTITLE("ETDSDAT")) == "ETDSDAT.FRX" ;
	OR UPPER(WTITLE("ETDSDAT")) == "ETDSDAT.QPR"
	DEFINE WINDOW etdsdat ;
		FROM INT((SROW()-14)/2),INT((SCOL()-75)/2) ;
		TO INT((SROW()-14)/2)+13,INT((SCOL()-75)/2)+74 ;
		TITLE "Enter Data For E-TDS" ;
		FOOTER "&Zco_Name" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		DOUBLE ;
		COLOR SCHEME 1
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                ETDSDATA/MS-DOS Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
lsele=select()
lord=order()


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     ETDSDATA/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("etdsdat")
	ACTIVATE WINDOW etdsdat SAME
ELSE
	ACTIVATE WINDOW etdsdat NOSHOW
ENDIF
@ 1,21 SAY "Section Code : " ;
	SIZE 1,15, 0
@ 1,1 SAY "Form No :" ;
	SIZE 1,9, 0
@ 5,1 SAY "Period Ending Date:" ;
	SIZE 1,19, 0
@ 1,46 SAY "TDS Challan No.:" ;
	SIZE 1,16, 0
@ 3,21 SAY "Certificate Furnished On :" ;
	SIZE 1,26, 0
@ 5,31 SAY "Grossing Up Indicator(Y/N) :  " ;
	SIZE 1,30, 0
@ 10,0 TO 10,72 DOUBLE
@ 3,1 SAY "TDS Rate:" ;
	SIZE 1,9, 0
@ 7,1 SAY "Selct 'A' if deduction is made at lower rate deduction or no tax deduc- " ;
	SIZE 1,72, 0
@ 8,1 SAY "-ted is on account of a certificate under section 197 or 195 or Select" ;
	SIZE 1,70, 0
@ 9,1 SAY "'B' if on account of certificate issued by a Chartered Accountant :" ;
	SIZE 1,67, 0
@ 1,10 GET m.TDSForm ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@M 26,27"
@ 1,35 GET m.TDSSec ;
	SIZE 1,10 ;
	DEFAULT " " ;
	WHEN list1('Sectioncod',2,35,'sections','TDSSec')
@ 1,62 GET m.chalno ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@K"
@ 3,10 GET m.tds_rate ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "@K 999.99"
@ 3,47 GET m.CertFernon ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	PICTURE "@EK"
@ 5,20 GET m.TDSPeriod ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	PICTURE "@EK"
@ 5,59 GET m.Grosup ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@M Yes,No"
@ 5,60 SAY iif(m.grosup='Y','es',iif(m.grosup='Y','o','')) ;
	SIZE 1,2
@ 9,68 GET m.Reason ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@M A,B"
@ 11,32 GET m.mok ;
	PICTURE "@*HN \!\<Ok" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _16p118ayt()

IF NOT WVISIBLE("etdsdat")
	ACTIVATE WINDOW etdsdat
ENDIF

READ CYCLE

RELEASE WINDOW etdsdat

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     ETDSDATA/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
sele (lsele)
set orde to &lord
if used('fldlist')
	sele fldlist
	use
endi
if used('sections')
	sele sections
	use
endi





*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*         ETDSDATA/MS-DOS Supporting Procedures and Functions    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
proc list1
para fldnm,rowno,colno,tablnm,fldrepl
sele dist sectioncod from sections into curs fldlist where forms=m.TDSForm
sele fldlist
flength=len(&fldnm)+2
if flength > 50
	flength=50
endi
define popup fldlst from rowno,colno to rowno+5,colno+flength prompt field &fldnm colo scheme 14 scroll shad
on selection popu fldlst deact popu fldlst
acti popup fldlst
if !empt(prompt())
if empt(fldrepl)
	fldnm1='m.'+fldnm
else
	fldnm1='m.'+fldrepl
endi	
&fldnm1=prompt()
endi	
return

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _16P118AYT           m.mok VALID                        
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ETDSDATA,     Record Number:   22  
*        Variable:            m.mok                              
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _16p118ayt     &&  m.mok VALID
#REGION 1
do case
	case m.mok=1
	deact wind etdsdat
	Keyboard '{Enter}'
endcase
